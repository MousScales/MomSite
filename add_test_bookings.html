<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Test Bookings</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .booking { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        button { padding: 10px 20px; margin: 5px; }
        .status { margin: 10px 0; padding: 10px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <h1>Add ALL Test Bookings (Aug 25-30)</h1>
    <button onclick="addAllBookings()">Add All Test Bookings</button>
    <div id="status"></div>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <!-- Config -->
    <script src="config.js"></script>

    <script>
        let db = null;

        // Initialize Firebase when the page loads
        window.addEventListener('load', function() {
            try {
                // Initialize Firebase if not already initialized
                if (!firebase.apps.length) {
                    firebase.initializeApp(firebaseConfig);
                }
                db = firebase.firestore();
                addStatus('✅ Firebase initialized successfully');
            } catch (error) {
                addStatus(`❌ Firebase initialization error: ${error.message}`, true);
            }
        });

        function addStatus(message, isError = false) {
            const statusDiv = document.getElementById('status');
            const div = document.createElement('div');
            div.className = isError ? 'status error' : 'status success';
            div.textContent = message;
            statusDiv.appendChild(div);
        }

        function generateBookingId() {
            return 'test_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        async function addAllBookings() {
            // Check if Firebase is initialized
            if (!db) {
                addStatus('❌ Firebase not initialized. Please wait and try again.', true);
                return;
            }

            addStatus('Starting to add ALL test bookings for August 25-30...');
            
            // ALL bookings across August 25-30, 2024
            const bookings = [
                // August 25th
                {
                    date: '2024-08-25',
                    time: '07:00',
                    duration: 180, // 3 hours (7am-10am)
                    name: 'Test Customer 1',
                    phone: '555-0001'
                },
                {
                    date: '2024-08-25',
                    time: '10:00',
                    duration: 180, // 3 hours (10am-1pm)
                    name: 'Test Customer 2',
                    phone: '555-0002'
                },
                {
                    date: '2024-08-25',
                    time: '13:00',
                    duration: 150, // 2.5 hours (1pm-3:30pm)
                    name: 'Test Customer 3',
                    phone: '555-0003'
                },
                {
                    date: '2024-08-25',
                    time: '15:30',
                    duration: 150, // 2.5 hours (3:30pm-6pm)
                    name: 'Test Customer 4',
                    phone: '555-0004'
                },
                
                // August 26th
                {
                    date: '2024-08-26',
                    time: '07:00',
                    duration: 180, // 3 hours (7am-10am)
                    name: 'Test Customer 5',
                    phone: '555-0005'
                },
                {
                    date: '2024-08-26',
                    time: '15:00',
                    duration: 120, // 2 hours (3pm-5pm)
                    name: 'Test Customer 6',
                    phone: '555-0006'
                },
                
                // August 27th
                {
                    date: '2024-08-27',
                    time: '07:00',
                    duration: 240, // 4 hours (7am-11am)
                    name: 'Test Customer 7',
                    phone: '555-0007'
                },
                {
                    date: '2024-08-27',
                    time: '11:00',
                    duration: 60, // 1 hour (11am-12pm)
                    name: 'Test Customer 8',
                    phone: '555-0008'
                },
                
                // August 28th
                {
                    date: '2024-08-28',
                    time: '07:00',
                    duration: 180, // 3 hours (7am-10am)
                    name: 'Test Customer 9',
                    phone: '555-0009'
                },
                {
                    date: '2024-08-28',
                    time: '09:00',
                    duration: 180, // 3 hours (9am-12pm)
                    name: 'Test Customer 10',
                    phone: '555-0010'
                },
                {
                    date: '2024-08-28',
                    time: '12:00',
                    duration: 60, // 1 hour (12pm-1pm)
                    name: 'Test Customer 11',
                    phone: '555-0011'
                },
                
                // August 29th
                {
                    date: '2024-08-29',
                    time: '10:00',
                    duration: 120, // 2 hours (10am-12pm)
                    name: 'Test Customer 12',
                    phone: '555-0012'
                },
                {
                    date: '2024-08-29',
                    time: '14:00',
                    duration: 120, // 2 hours (2pm-4pm)
                    name: 'Test Customer 13',
                    phone: '555-0013'
                },
                
                // August 30th
                {
                    date: '2024-08-30',
                    time: '07:00',
                    duration: 180, // 3 hours (7am-10am)
                    name: 'Test Customer 14',
                    phone: '555-0014'
                },
                {
                    date: '2024-08-30',
                    time: '10:00',
                    duration: 120, // 2 hours (10am-12pm)
                    name: 'Test Customer 15',
                    phone: '555-0015'
                }
            ];
            
            let bookingCount = 0;
            
            for (const booking of bookings) {
                const bookingDate = new Date(booking.date);
                const [hours, minutes] = booking.time.split(':');
                bookingDate.setHours(parseInt(hours), parseInt(minutes), 0, 0);
                
                const bookingId = generateBookingId();
                const totalPrice = Math.round(booking.duration / 60 * 50); // $50 per hour
                const deposit = Math.round(totalPrice * 0.1); // 10% deposit
                
                const bookingData = {
                    bookingId: bookingId,
                    name: booking.name,
                    phone: booking.phone,
                    email: `${booking.name.toLowerCase().replace(' ', '')}@example.com`,
                    appointmentDate: booking.date,
                    appointmentTime: booking.time,
                    style: 'Box Braids',
                    hairLength: 'Medium',
                    duration: booking.duration,
                    totalPrice: totalPrice,
                    deposit: deposit,
                    remainingBalance: totalPrice - deposit,
                    status: 'confirmed',
                    createdAt: new Date().toISOString()
                };
                
                try {
                    await db.collection('bookings').doc(bookingId).set(bookingData);
                    addStatus(`Added ${booking.date} ${booking.time} booking: ${booking.name} (${booking.duration} min)`);
                    bookingCount++;
                } catch (error) {
                    addStatus(`Error adding ${booking.date} ${booking.time} booking: ${error.message}`, true);
                }
                
                // Small delay to avoid overwhelming the database
                await new Promise(resolve => setTimeout(resolve, 100));
            }
            
            addStatus(`✅ Completed! Added ${bookingCount} test bookings for August 25-30.`);
            addStatus('Now syncing to Google Calendar...');
            
            // Sync to Google Calendar
            try {
                const response = await fetch('https://us-central1-connect-2a17c.cloudfunctions.net/syncAllBookingsToGoogleCalendar', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                const result = await response.json();
                
                if (result.success) {
                    addStatus(`✅ Successfully synced ${result.successCount} bookings to Google Calendar!`);
                    addStatus(`Total bookings processed: ${result.totalBookings}`);
                    if (result.errorCount > 0) {
                        addStatus(`⚠️ ${result.errorCount} bookings had sync errors`, true);
                    }
                } else {
                    addStatus(`❌ Error syncing to Google Calendar: ${result.message}`, true);
                }
            } catch (error) {
                addStatus(`❌ Error syncing to Google Calendar: ${error.message}`, true);
            }
        }
    </script>
</body>
</html> 